<!--<!DOCTYPE html>-->
<!--<html>-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <title>Native WebSocket Example</title>-->
<!--</head>-->
<!--<body>-->
<!--<h3># TEST #</h3>-->
<!--<script>-->
<!--    // 웹소켓 전역 객체 생성-->
<!--    var ws = new WebSocket("ws://localhost:3000");-->

<!--    // 연결이 수립되면 서버에 메시지를 전송한다-->
<!--    ws.onopen = function(event) {-->
<!--        ws.send("Client message: Hi!");-->
<!--    }-->

<!--    // 서버로 부터 메시지를 수신한다-->
<!--    ws.onmessage = function(event) {-->
<!--        console.log("Server message: ", event.data);-->
<!--    }-->

<!--    // error event handler-->
<!--    ws.onerror = function(event) {-->
<!--        console.log("Server error message: ", event.data);-->
<!--    }-->
<!--</script>-->
<!--</body>-->
<!--</html>-->

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Socket.io Chat Example</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
</head>
<body>
<div class="container">
    <h3>Socket.io Chat Example</h3>
    <form class="form-inline">
        <div class="form-group">
            <label for="msgForm">Message: </label>
            <input type="text" placeholder="메시지를 입력해주세요 :)" class="form-control" id="msgForm">
        </div>
        <button type="submit" class="btn btn-primary">Send</button>
    </form>
    <div id="chatLogs"></div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script>
    $(function(){
        // socket.io 서버에 접속한다
        var socket = io();

        // 서버로 자신의 정보를 전송한다.
        socket.emit("login", {
            // name: "ungmo2",
            //name: makeRandomName(),
            name: "Dongryul",
            userid: "ungmo2@gmail.com"
        });



        // 서버로부터의 메시지가 수신되면
        socket.on("login", function(data) {
            $("#chatLogs").append("<div><strong>" + data + "</strong> has joined</div>");
        });

        // 서버로부터의 메시지가 수신되면
        socket.on("s2c chat", function(data) {
            //$("#chatLogs").append("<div>" + data.msg + " : from <strong>" + data.from.name + "</strong></div>");

            $("#chatLogs").append("<div>" + data.from.name + " : " + data.msg + "</div>");

        });

        // Send 버튼이 클릭되면
        $("form").submit(function(e) {
            e.preventDefault();
            var $msgForm = $("#msgForm");

            // 서버로 메시지를 전송한다.
            socket.emit("chat", { msg: $msgForm.val() });
            $msgForm.val("");
        });

        function makeRandomName(){
            var name = "";
            var possible = "abcdefghijklmnopqrstuvwxyz";
            for( var i = 0; i < 3; i++ ) {
                name += possible.charAt(Math.floor(Math.random() * possible.length));
            }
            return name;
        }
    });
</script>
</body>
</html>